<?php

namespace FM\SymSlateBundle\Entity;

use Doctrine\ORM\EntityRepository;

/**
 * MessagesImportRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class MessagesImportRepository extends EntityRepository
{
	public function saveMessages($messages_import, $messages)
	{
		$em = $this->getEntityManager();
		$mr = $em->getRepository('FMSymSlateBundle:Message');
		foreach($messages as $message)
		{
			if($mr->findByMkey($message->getMkey()))
			{
				//do nothing if the message is already there
			}			
			else
			{
				$message->setMessagesImport($messages_import);
				$em->persist($message);
				$em->flush();
			}
		}
	}
}
